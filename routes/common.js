const express       = require('express');
const file_worker   = require('../worker/file_process');
const router        = express.Router();

function map_geometry() {
    return JSON.stringify(
        {
            "config":{
                        box_size:[280,550],
                        title:[140,20],
                        legend:[100,535]
                    },
            "geometry":{
                    "GG": {
                        "name":"경기",
                        "start":[50,104],
                        "point":[[25,-25],[45,25],[-5,25],[25,10],[-45,60],[-25,-20],[-40,-70],[25,10]],
                        "text":[80,120]
                    },
                    "GW": {
                        "name":"강원",
                        "start":[80,75],
                        "point":[[10,-10],[70,0],[20,-30],[70,140],[10,60],[-10,0],[-5,-20],[-20,-20],[-55,-20],[-50,0],[28,-38],[-27,-10],[5,-25]],
                        "text":[180,110]
                    },
                    "GB": {
                        "name":"경북",
                        "start":[142,230],
                        "point":[[58,-40],[25,10],[15,15],[7,25],[13,0],[0,20],[-5,30],[5,10],[10,-10],[-10,40],[-90,0],[-30,-20],[0,-15],[11,-22],[-10,-5]],
                        "text":[200,260]
                    },
                    "CB": {
                        "name":"충북",
                        "start":[97,203],
                        "point":[[20,-24],[50,0],[30,10],[-60,40],[0,40],[10,5],[-10,20],[-20,0],[-30,-50]],
                        "text":[115,220]
                    },
                    "CN": {
                        "name":"충남",
                        "start":[70,185],
                        "point":[[23,19],[-10,40],[30,50],[-40,-10],[-30,10],[-10,-20],[0,-50],[-30,-20],[60,-20],[0,20]],
                        "text":[60,235]
                    },
                    "GN": {
                        "name":"경남",
                        "start":[138,313],
                        "point":[[30,20],[92,0],[0,10],[-20,30],[-10,10],[-20,0],[-10,-10],[-5,10],[-20,20],[-10,-5],[0,-10],[-20,15],[-20,-31],[6,-17],[-5,-15],[5,-20]],
                        "text":[180,350]
                    },
                    "JB": {
                        "name":"전북",
                        "start":[28,302],
                        "point":[[45,-15],[40,10],[25,0],[0,13],[-10,10],[-5,20],[5,15],[-5,15],[-40,0],[-5,-15],[-20,0],[0,10],[-35,0],[15,-45],[10,5],[5,-15],[-20,0]],
                        "text":[85,310]
                    },
                    "JN": {
                        "name":"전남",
                        "start":[22,368],
                        "point":[[40,0],[0,-10],[15,0],[5,15],[41,0],[20,30],[-85,55],[-5,-15],[-15,25],[-5,-45],[-10,0]],
                        "text":[70,390]
                    },
                    "JJ": {
                        "name":"제주",
                        "start":[20,520],
                        "point":[[25,-10],[15,0],[10,10],[-10,10],[-20,10],[-25,0],[-5,-5]],
                        "text":[40,510]
                    }
            }
        }
    );
}

router.post('/hive_stat', async function(req, res) {
    const response = {
        log: await file_worker.hive_stat(),
        map: map_geometry()
    }
    res.status(200).send(JSON.stringify(response));
});

module.exports = router;